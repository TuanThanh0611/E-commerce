"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = update;
const devkit_1 = require("@nx/devkit");
async function update(host) {
    const nxJson = (0, devkit_1.readJson)(host, 'nx.json');
    let cacheableOperationsPreNx17 = nxJson.tasksRunnerOptions?.['default']?.options?.cacheableOperations;
    if (cacheableOperationsPreNx17?.includes['install'] === false) {
        cacheableOperationsPreNx17 = [...cacheableOperationsPreNx17, 'install'];
        (0, devkit_1.writeJson)(host, 'nx.json', nxJson);
    }
    else {
        nxJson.targetDefaults ??= {};
        nxJson.targetDefaults['install'] ??= {};
        nxJson.targetDefaults['install'].cache ??= true;
        (0, devkit_1.writeJson)(host, 'nx.json', nxJson);
    }
    await (0, devkit_1.formatFiles)(host);
}
//# sourceMappingURL=add-install-to-cacheable-operations.js.map