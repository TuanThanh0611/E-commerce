import { isPlatformBrowser } from '@angular/common';
import * as queryDevtools from '@tanstack/query-devtools';
import { ChangeDetectionStrategy, Component, Input, PLATFORM_ID, ViewChild, booleanAttribute, inject, } from '@angular/core';
import { injectQueryClient, onlineManager, } from '@tanstack/angular-query-experimental';
import * as i0 from "@angular/core";
export class AngularQueryDevtools {
    /*
     * It is intentional that there are no default values on inputs.
     * Core devtools will set defaults when values are undefined.
     *
     * Signal inputs are not used to remain compatible with previous Angular versions.
     */
    /**
     * Add this attribute if you want the dev tools to default to being open
     * @example
     * <angular-query-devtools initialIsOpen />
     */
    initialIsOpen;
    /**
     * The position of the TanStack logo to open and close the devtools panel.
     * `top-left` | `top-right` | `bottom-left` | `bottom-right` | `relative`
     * Defaults to `bottom-right`.
     * If `relative`, the button is placed in the location that you render the devtools.
     * @example
     * <angular-query-devtools buttonPosition="top-right" />
     */
    buttonPosition;
    /**
     * The position of the Angular Query devtools panel.
     * `top` | `bottom` | `left` | `right`
     * Defaults to `bottom`.
     * @example
     * <angular-query-devtools position="bottom" />
     */
    position;
    /**
     * Custom instance of QueryClient
     * @example
     * <angular-query-devtools [client]="queryClient" />
     */
    client;
    /**
     * Use this to pass a nonce to the style tag that is added to the document head. This is useful if you are using a Content Security Policy (CSP) nonce to allow inline styles.
     * @example
     * <angular-query-devtools styleNonce="YourRandomNonceValue" />
     */
    styleNonce;
    /**
     * Use this so you can attach the devtool's styles to specific element in the DOM.
     */
    shadowDOMTarget;
    /**
     * Use this so you can define custom errors that can be shown in the devtools.
     */
    errorTypes;
    ref;
    #devtools;
    #isBrowser = isPlatformBrowser(inject(PLATFORM_ID));
    #injectedClient = this.#isBrowser
        ? injectQueryClient({
            optional: true,
        })
        : null;
    ngOnChanges(changes) {
        if (!this.#devtools)
            return;
        if (changes['client']) {
            this.#devtools.setClient(this.#getAppliedQueryClient());
        }
        if (changes['buttonPosition'] && this.buttonPosition !== undefined) {
            this.#devtools.setButtonPosition(this.buttonPosition);
        }
        if (changes['position'] && this.position !== undefined) {
            this.#devtools.setPosition(this.position);
        }
        if (changes['initialIsOpen'] && this.initialIsOpen !== undefined) {
            this.#devtools.setInitialIsOpen(this.initialIsOpen);
        }
        if (changes['errorTypes'] && this.errorTypes !== undefined) {
            this.#devtools.setErrorTypes(this.errorTypes);
        }
    }
    ngAfterViewInit() {
        if (!this.#isBrowser)
            return;
        const devtools = new queryDevtools.TanstackQueryDevtools({
            client: this.#getAppliedQueryClient(),
            queryFlavor: 'Angular Query',
            version: '5',
            onlineManager,
            buttonPosition: this.buttonPosition,
            position: this.position,
            initialIsOpen: this.initialIsOpen,
            errorTypes: this.errorTypes,
            styleNonce: this.styleNonce,
            shadowDOMTarget: this.shadowDOMTarget,
        });
        devtools.mount(this.ref.nativeElement);
        this.#devtools = devtools;
    }
    ngOnDestroy() {
        this.#devtools?.unmount();
    }
    #getAppliedQueryClient() {
        const client = this.client ?? this.#injectedClient;
        if (!client) {
            throw new Error('You must either provide a client via `provideAngularQuery` ' +
                'or pass it to the `client` attribute of `<angular-query-devtools>`.');
        }
        return client;
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: AngularQueryDevtools, deps: [], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "16.1.0", version: "17.3.12", type: AngularQueryDevtools, isStandalone: true, selector: "angular-query-devtools", inputs: { initialIsOpen: ["initialIsOpen", "initialIsOpen", booleanAttribute], buttonPosition: "buttonPosition", position: "position", client: "client", styleNonce: "styleNonce", shadowDOMTarget: "shadowDOMTarget", errorTypes: "errorTypes" }, host: { attributes: { "ngSkipHydration": "true" } }, viewQueries: [{ propertyName: "ref", first: true, predicate: ["ref"], descendants: true }], usesOnChanges: true, ngImport: i0, template: `<div class="tsqd-parent-container" #ref></div>`, isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: AngularQueryDevtools, decorators: [{
            type: Component,
            args: [{
                    selector: 'angular-query-devtools',
                    standalone: true,
                    template: `<div class="tsqd-parent-container" #ref></div>`,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    host: { ngSkipHydration: 'true' },
                }]
        }], propDecorators: { initialIsOpen: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], buttonPosition: [{
                type: Input
            }], position: [{
                type: Input
            }], client: [{
                type: Input
            }], styleNonce: [{
                type: Input
            }], shadowDOMTarget: [{
                type: Input
            }], errorTypes: [{
                type: Input
            }], ref: [{
                type: ViewChild,
                args: ['ref']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhci1xdWVyeS1kZXZ0b29scy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYW5ndWxhci1xdWVyeS1kZXZ0b29scy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUE7QUFDbkQsT0FBTyxLQUFLLGFBQWEsTUFBTSwwQkFBMEIsQ0FBQTtBQUN6RCxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFFVCxLQUFLLEVBQ0wsV0FBVyxFQUNYLFNBQVMsRUFDVCxnQkFBZ0IsRUFDaEIsTUFBTSxHQUNQLE1BQU0sZUFBZSxDQUFBO0FBQ3RCLE9BQU8sRUFFTCxpQkFBaUIsRUFDakIsYUFBYSxHQUNkLE1BQU0sc0NBQXNDLENBQUE7O0FBbUI3QyxNQUFNLE9BQU8sb0JBQW9CO0lBRy9COzs7OztPQUtHO0lBRUg7Ozs7T0FJRztJQUNxQyxhQUFhLENBQVU7SUFFL0Q7Ozs7Ozs7T0FPRztJQUNNLGNBQWMsQ0FBdUM7SUFFOUQ7Ozs7OztPQU1HO0lBQ00sUUFBUSxDQUFpQztJQUVsRDs7OztPQUlHO0lBQ00sTUFBTSxDQUFjO0lBRTdCOzs7O09BSUc7SUFDTSxVQUFVLENBQVM7SUFFNUI7O09BRUc7SUFDTSxlQUFlLENBQWE7SUFFckM7O09BRUc7SUFDTSxVQUFVLENBQTJCO0lBRTVCLEdBQUcsQ0FBYTtJQUVsQyxTQUFTLENBQXdCO0lBRXhCLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQTtJQUVuRCxlQUFlLEdBQXVCLElBQUksQ0FBQyxVQUFVO1FBQzVELENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztZQUNoQixRQUFRLEVBQUUsSUFBSTtTQUNmLENBQUM7UUFDSixDQUFDLENBQUMsSUFBSSxDQUFBO0lBRVIsV0FBVyxDQUFDLE9BQXNCO1FBQ2hDLElBQUksQ0FBQyxJQUFJLENB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QUs7Z0JBU0csUUFBUTtzQkFBaEIsS0FBSztnQkFPRyxNQUFNO3NCQUFkLEtBQUs7Z0JBT0csVUFBVTtzQkFBbEIsS0FBSztnQkFLRyxlQUFlO3NCQUF2QixLQUFLO2dCQUtHLFVBQVU7c0JBQWxCLEtBQUs7Z0JBRVksR0FBRztzQkFBcEIsU0FBUzt1QkFBQyxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nXG5pbXBvcnQgKiBhcyBxdWVyeURldnRvb2xzIGZyb20gJ0B0YW5zdGFjay9xdWVyeS1kZXZ0b29scydcbmltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIElucHV0LFxuICBQTEFURk9STV9JRCxcbiAgVmlld0NoaWxkLFxuICBib29sZWFuQXR0cmlidXRlLFxuICBpbmplY3QsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnXG5pbXBvcnQge1xuICBRdWVyeUNsaWVudCxcbiAgaW5qZWN0UXVlcnlDbGllbnQsXG4gIG9ubGluZU1hbmFnZXIsXG59IGZyb20gJ0B0YW5zdGFjay9hbmd1bGFyLXF1ZXJ5LWV4cGVyaW1lbnRhbCdcbmltcG9ydCB0eXBlIHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIFNpbXBsZUNoYW5nZXMsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnXG5pbXBvcnQgdHlwZSB7XG4gIERldnRvb2xzRXJyb3JUeXBlLFxuICBUYW5zdGFja1F1ZXJ5RGV2dG9vbHMsXG59IGZyb20gJ0B0YW5zdGFjay9xdWVyeS1kZXZ0b29scydcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYW5ndWxhci1xdWVyeS1kZXZ0b29scycsXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIHRlbXBsYXRlOiBgPGRpdiBjbGFzcz1cInRzcWQtcGFyZW50LWNvbnRhaW5lclwiICNyZWY+PC9kaXY+YCxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIGhvc3Q6IHsgbmdTa2lwSHlkcmF0aW9uOiAndHJ1ZScgfSxcbn0pXG5leHBvcnQgY2xhc3MgQW5ndWxhclF1ZXJ5RGV2dG9vbHNcbiAgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveVxue1xuICAvKlxuICAgKiBJdCBpcyBpbnRlbnRpb25hbCB0aGF0IHRoZXJlIGFyZSBubyBkZWZhdWx0IHZhbHVlcyBvbiBpbnB1dHMuXG4gICAqIENvcmUgZGV2dG9vbHMgd2lsbCBzZXQgZGVmYXVsdHMgd2hlbiB2YWx1ZXMgYXJlIHVuZGVmaW5lZC5cbiAgICpcbiAgICogU2lnbmFsIGlucHV0cyBhcmUgbm90IHVzZWQgdG8gcmVtYWluIGNvbXBhdGlibGUgd2l0aCBwcmV2aW91cyBBbmd1bGFyIHZlcnNpb25zLlxuICAgKi9cblxuICAvKipcbiAgICogQWRkIHRoaXMgYXR0cmlidXRlIGlmIHlvdSB3YW50IHRoZSBkZXYgdG9vbHMgdG8gZGVmYXVsdCB0byBiZWluZyBvcGVuXG4gICAqIEBleGFtcGxlXG4gICAqIDxhbmd1bGFyLXF1ZXJ5LWRldnRvb2xzIGluaXRpYWxJc09wZW4gLz5cbiAgICovXG4gIEBJbnB1dCh7IHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSB9KSBpbml0aWFsSXNPcGVuPzogYm9vbGVhblxuXG4gIC8qKlxuICAgKiBUaGUgcG9zaXRpb24gb2YgdGhlIFRhblN0YWNrIGxvZ28gdG8gb3BlbiBhbmQgY2xvc2UgdGhlIGRldnRvb2xzIHBhbmVsLlxuICAgKiBgdG9wLWxlZnRgIHwgYHRvcC1yaWdodGAgfCBgYm90dG9tLWxlZnRgIHwgYGJvdHRvbS1yaWdodGAgfCBgcmVsYXRpdmVgXG4gICAqIERlZmF1bHRzIHRvIGBib3R0b20tcmlnaHRgLlxuICAgKiBJZiBgcmVsYXRpdmVgLCB0aGUgYnV0dG9uIGlzIHBsYWNlZCBpbiB0aGUgbG9jYXRpb24gdGhhdCB5b3UgcmVuZGVyIHRoZSBkZXZ0b29scy5cbiAgICogQGV4YW1wbGVcbiAgICogPGFuZ3VsYXItcXVlcnktZGV2dG9vbHMgYnV0dG9uUG9zaXRpb249XCJ0b3AtcmlnaHRcIiAvPlxuICAgKi9cbiAgQElucHV0KCkgYnV0dG9uUG9zaXRpb24/OiBxdWVyeURldnRvb2xzLkRldnRvb2xzQnV0dG9uUG9zaXRpb25cblxuICAvKipcbiAgICogVGhlIHBvc2l0aW9uIG9mIHRoZSBBbmd1bGFyIFF1ZXJ5IGRldnRvb2xzIHBhbmVsLlxuICAgKiBgdG9wYCB8IGBib3R0b21gIHwgYGxlZnRgIHwgYHJpZ2h0YFxuICAgKiBEZWZhdWx0cyB0byBgYm90dG9tYC5cbiAgICogQGV4YW1wbGVcbiAgICogPGFuZ3VsYXItcXVlcnktZGV2dG9vbHMgcG9zaXRpb249XCJib3R0b21cIiAvPlxuICAgKi9cbiAgQElucHV0KCkgcG9zaXRpb24/OiBxdWVyeURldnRvb2xzLkRldnRvb2xzUG9zaXRpb25cblxuICAvKipcbiAgICogQ3VzdG9tIGluc3RhbmNlIG9mIFF1ZXJ5Q2xpZW50XG4gICAqIEBleGFtcGxlXG4gICAqIDxhbmd1bGFyLXF1ZXJ5LWRldnRvb2xzIFtjbGllbnRdPVwicXVlcnlDbGllbnRcIiAvPlxuICAgKi9cbiAgQElucHV0KCkgY2xpZW50PzogUXVlcnlDbGllbnRcblxuICAvKipcbiAgICogVXNlIHRoaXMgdG8gcGFzcyBhIG5vbmNlIHRvIHRoZSBzdHlsZSB0YWcgdGhhdCBpcyBhZGRlZCB0byB0aGUgZG9jdW1lbnQgaGVhZC4gVGhpcyBpcyB1c2VmdWwgaWYgeW91IGFyZSB1c2luZyBhIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5IChDU1ApIG5vbmNlIHRvIGFsbG93IGlubGluZSBzdHlsZXMuXG4gICAqIEBleGFtcGxlXG4gICAqIDxhbmd1bGFyLXF1ZXJ5LWRldnRvb2xzIHN0eWxlTm9uY2U9XCJZb3VyUmFuZG9tTm9uY2VWYWx1ZVwiIC8+XG4gICAqL1xuICBASW5wdXQoKSBzdHlsZU5vbmNlPzogc3RyaW5nXG5cbiAgLyoqXG4gICAqIFVzZSB0aGlzIHNvIHlvdSBjYW4gYXR0YWNoIHRoZSBkZXZ0b29sJ3Mgc3R5bGVzIHRvIHNwZWNpZmljIGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICovXG4gIEBJbnB1dCgpIHNoYWRvd0RPTVRhcmdldD86IFNoYWRvd1Jvb3RcblxuICAvKipcbiAgICogVXNlIHRoaXMgc28geW91IGNhbiBkZWZpbmUgY3VzdG9tIGVycm9ycyB0aGF0IGNhbiBiZSBzaG93biBpbiB0aGUgZGV2dG9vbHMuXG4gICAqL1xuICBASW5wdXQoKSBlcnJvclR5cGVzPzogQXJyYXk8RGV2dG9vbHNFcnJvclR5cGU+XG5cbiAgQFZpZXdDaGlsZCgncmVmJykgcmVmITogRWxlbWVudFJlZlxuXG4gICNkZXZ0b29scz86IFRhbnN0YWNrUXVlcnlEZXZ0b29sc1xuXG4gIHJlYWRvbmx5ICNpc0Jyb3dzZXIgPSBpc1BsYXRmb3JtQnJvd3NlcihpbmplY3QoUExBVEZPUk1fSUQpKVxuXG4gIHJlYWRvbmx5ICNpbmplY3RlZENsaWVudDogUXVlcnlDbGllbnQgfCBudWxsID0gdGhpcy4jaXNCcm93c2VyXG4gICAgPyBpbmplY3RRdWVyeUNsaWVudCh7XG4gICAgICAgIG9wdGlvbmFsOiB0cnVlLFxuICAgICAgfSlcbiAgICA6IG51bGxcblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKCF0aGlzLiNkZXZ0b29scykgcmV0dXJuXG4gICAgaWYgKGNoYW5nZXNbJ2NsaWVudCddKSB7XG4gICAgICB0aGlzLiNkZXZ0b29scy5zZXRDbGllbnQodGhpcy4jZ2V0QXBwbGllZFF1ZXJ5Q2xpZW50KCkpXG4gICAgfVxuICAgIGlmIChjaGFuZ2VzWydidXR0b25Qb3NpdGlvbiddICYmIHRoaXMuYnV0dG9uUG9zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy4jZGV2dG9vbHMuc2V0QnV0dG9uUG9zaXRpb24odGhpcy5idXR0b25Qb3NpdGlvbilcbiAgICB9XG4gICAgaWYgKGNoYW5nZXNbJ3Bvc2l0aW9uJ10gJiYgdGhpcy5wb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLiNkZXZ0b29scy5zZXRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKVxuICAgIH1cbiAgICBpZiAoY2hhbmdlc1snaW5pdGlhbElzT3BlbiddICYmIHRoaXMuaW5pdGlhbElzT3BlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLiNkZXZ0b29scy5zZXRJbml0aWFsSXNPcGVuKHRoaXMuaW5pdGlhbElzT3BlbilcbiAgICB9XG4gICAgaWYgKGNoYW5nZXNbJ2Vycm9yVHlwZXMnXSAmJiB0aGlzLmVycm9yVHlwZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy4jZGV2dG9vbHMuc2V0RXJyb3JUeXBlcyh0aGlzLmVycm9yVHlwZXMpXG4gICAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGlmICghdGhpcy4jaXNCcm93c2VyKSByZXR1cm5cbiAgICBjb25zdCBkZXZ0b29scyA9IG5ldyBxdWVyeURldnRvb2xzLlRhbnN0YWNrUXVlcnlEZXZ0b29scyh7XG4gICAgICBjbGllbnQ6IHRoaXMuI2dldEFwcGxpZWRRdWVyeUNsaWVudCgpLFxuICAgICAgcXVlcnlGbGF2b3I6ICdBbmd1bGFyIFF1ZXJ5JyxcbiAgICAgIHZlcnNpb246ICc1JyxcbiAgICAgIG9ubGluZU1hbmFnZXIsXG4gICAgICBidXR0b25Qb3NpdGlvbjogdGhpcy5idXR0b25Qb3NpdGlvbixcbiAgICAgIHBvc2l0aW9uOiB0aGlzLnBvc2l0aW9uLFxuICAgICAgaW5pdGlhbElzT3BlbjogdGhpcy5pbml0aWFsSXNPcGVuLFxuICAgICAgZXJyb3JUeXBlczogdGhpcy5lcnJvclR5cGVzLFxuICAgICAgc3R5bGVOb25jZTogdGhpcy5zdHlsZU5vbmNlLFxuICAgICAgc2hhZG93RE9NVGFyZ2V0OiB0aGlzLnNoYWRvd0RPTVRhcmdldCxcbiAgICB9KVxuICAgIGRldnRvb2xzLm1vdW50KHRoaXMucmVmLm5hdGl2ZUVsZW1lbnQpXG4gICAgdGhpcy4jZGV2dG9vbHMgPSBkZXZ0b29sc1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy4jZGV2dG9vbHM/LnVubW91bnQoKVxuICB9XG5cbiAgI2dldEFwcGxpZWRRdWVyeUNsaWVudCgpIHtcbiAgICBjb25zdCBjbGllbnQgPSB0aGlzLmNsaWVudCA/PyB0aGlzLiNpbmplY3RlZENsaWVudFxuICAgIGlmICghY2xpZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdZb3UgbXVzdCBlaXRoZXIgcHJvdmlkZSBhIGNsaWVudCB2aWEgYHByb3ZpZGVBbmd1bGFyUXVlcnlgICcgK1xuICAgICAgICAgICdvciBwYXNzIGl0IHRvIHRoZSBgY2xpZW50YCBhdHRyaWJ1dGUgb2YgYDxhbmd1bGFyLXF1ZXJ5LWRldnRvb2xzPmAuJyxcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIGNsaWVudFxuICB9XG59XG4iXX0=