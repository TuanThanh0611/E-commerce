{"version":3,"file":"tanstack-angular-query-devtools-experimental.mjs","sources":["../../src/angular-query-devtools.component.ts","../../src/tanstack-angular-query-devtools-experimental.ts"],"sourcesContent":["import { isPlatformBrowser } from '@angular/common'\nimport * as queryDevtools from '@tanstack/query-devtools'\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Input,\n  PLATFORM_ID,\n  ViewChild,\n  booleanAttribute,\n  inject,\n} from '@angular/core'\nimport {\n  QueryClient,\n  injectQueryClient,\n  onlineManager,\n} from '@tanstack/angular-query-experimental'\nimport type {\n  AfterViewInit,\n  OnChanges,\n  OnDestroy,\n  SimpleChanges,\n} from '@angular/core'\nimport type {\n  DevtoolsErrorType,\n  TanstackQueryDevtools,\n} from '@tanstack/query-devtools'\n\n@Component({\n  selector: 'angular-query-devtools',\n  standalone: true,\n  template: `<div class=\"tsqd-parent-container\" #ref></div>`,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  host: { ngSkipHydration: 'true' },\n})\nexport class AngularQueryDevtools\n  implements AfterViewInit, OnChanges, OnDestroy\n{\n  /*\n   * It is intentional that there are no default values on inputs.\n   * Core devtools will set defaults when values are undefined.\n   *\n   * Signal inputs are not used to remain compatible with previous Angular versions.\n   */\n\n  /**\n   * Add this attribute if you want the dev tools to default to being open\n   * @example\n   * <angular-query-devtools initialIsOpen />\n   */\n  @Input({ transform: booleanAttribute }) initialIsOpen?: boolean\n\n  /**\n   * The position of the TanStack logo to open and close the devtools panel.\n   * `top-left` | `top-right` | `bottom-left` | `bottom-right` | `relative`\n   * Defaults to `bottom-right`.\n   * If `relative`, the button is placed in the location that you render the devtools.\n   * @example\n   * <angular-query-devtools buttonPosition=\"top-right\" />\n   */\n  @Input() buttonPosition?: queryDevtools.DevtoolsButtonPosition\n\n  /**\n   * The position of the Angular Query devtools panel.\n   * `top` | `bottom` | `left` | `right`\n   * Defaults to `bottom`.\n   * @example\n   * <angular-query-devtools position=\"bottom\" />\n   */\n  @Input() position?: queryDevtools.DevtoolsPosition\n\n  /**\n   * Custom instance of QueryClient\n   * @example\n   * <angular-query-devtools [client]=\"queryClient\" />\n   */\n  @Input() client?: QueryClient\n\n  /**\n   * Use this to pass a nonce to the style tag that is added to the document head. This is useful if you are using a Content Security Policy (CSP) nonce to allow inline styles.\n   * @example\n   * <angular-query-devtools styleNonce=\"YourRandomNonceValue\" />\n   */\n  @Input() styleNonce?: string\n\n  /**\n   * Use this so you can attach the devtool's styles to specific element in the DOM.\n   */\n  @Input() shadowDOMTarget?: ShadowRoot\n\n  /**\n   * Use this so you can define custom errors that can be shown in the devtools.\n   */\n  @Input() errorTypes?: Array<DevtoolsErrorType>\n\n  @ViewChild('ref') ref!: ElementRef\n\n  #devtools?: TanstackQueryDevtools\n\n  readonly #isBrowser = isPlatformBrowser(inject(PLATFORM_ID))\n\n  readonly #injectedClient: QueryClient | null = this.#isBrowser\n    ? injectQueryClient({\n        optional: true,\n      })\n    : null\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (!this.#devtools) return\n    if (changes['client']) {\n      this.#devtools.setClient(this.#getAppliedQueryClient())\n    }\n    if (changes['buttonPosition'] && this.buttonPosition !== undefined) {\n      this.#devtools.setButtonPosition(this.buttonPosition)\n    }\n    if (changes['position'] && this.position !== undefined) {\n      this.#devtools.setPosition(this.position)\n    }\n    if (changes['initialIsOpen'] && this.initialIsOpen !== undefined) {\n      this.#devtools.setInitialIsOpen(this.initialIsOpen)\n    }\n    if (changes['errorTypes'] && this.errorTypes !== undefined) {\n      this.#devtools.setErrorTypes(this.errorTypes)\n    }\n  }\n\n  ngAfterViewInit() {\n    if (!this.#isBrowser) return\n    const devtools = new queryDevtools.TanstackQueryDevtools({\n      client: this.#getAppliedQueryClient(),\n      queryFlavor: 'Angular Query',\n      version: '5',\n      onlineManager,\n      buttonPosition: this.buttonPosition,\n      position: this.position,\n      initialIsOpen: this.initialIsOpen,\n      errorTypes: this.errorTypes,\n      styleNonce: this.styleNonce,\n      shadowDOMTarget: this.shadowDOMTarget,\n    })\n    devtools.mount(this.ref.nativeElement)\n    this.#devtools = devtools\n  }\n\n  ngOnDestroy() {\n    this.#devtools?.unmount()\n  }\n\n  #getAppliedQueryClient() {\n    const client = this.client ?? this.#injectedClient\n    if (!client) {\n      throw new Error(\n        'You must either provide a client via `provideAngularQuery` ' +\n          'or pass it to the `client` attribute of `<angular-query-devtools>`.',\n      )\n    }\n    return client\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}